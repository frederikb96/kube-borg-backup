apiVersion: v1
kind: Secret
metadata:
  name: {{ include "snapshot-borgbackup.borgConfigSecret" . }}
  namespace: {{ .Values.namespace.name }}
type: Opaque
stringData:
  config.yaml: |
    namespace: {{ .Values.namespace.name }}
    pod:
      name: {{ .Values.borgbackup.pod.name }}
      image: {{ .Values.borgbackup.pod.image }}
      repoSecret: {{ .Values.borgbackup.repoSecret.name }}
      sshSecret: {{ .Values.borgbackup.sshSecret.name }}
      cachePVC: {{ .Values.borgbackup.cache.pvcName }}
      borgFlags: {{ .Values.borgbackup.borgFlags | quote }}
      timeoutSeconds: {{ .Values.borgbackup.pod.timeoutSeconds }}
    backups:
{{ toYaml .Values.borgbackup.backups | indent 6 }}
